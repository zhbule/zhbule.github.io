<!DOCTYPE html>

<head>
    <meta charset="utf-8" />
    <title>用户中心 - 小猫网</title>
    <link href="css/css.css" rel="stylesheet" />
</head>

<body>
    <div class="logo">
        <a href="#"><img src="images/logo.jpg" /></a>
    </div>
    <div class="nav">
        <ul>
            <li><a href="index.html"><img src="images/nav1.jpg" />首页</a></li>
            <li><a href="zhidao.html"><img src="images/nav2.jpg" />养猫知道</a></li>
            <li><a href="jieshao.html"><img src="images/nav3.jpg" />小猫介绍</a></li>
            <li><a href="tuji.html"><img src="images/nav4.jpg" />小猫图集</a></li>
            <li><a href="lingyang.html"><img src="images/nav5.jpg" />领养小猫</a></li>
            <li><a href="liuyan.html"><img src="images/nav6.jpg" />在线留言</a></li>
        </ul>
    </div>
    <div class="topsite">
        <div class="sear">
            <input type="text" class="text" />
            <input type="button" class="btn" value="搜索">
        </div>
        <div class="link">
            <span>热门搜索：</span>
            <a href="jieshao.html#buoumao">布偶猫</a>
            <a href="jieshao.html#lanjianceng">蓝渐层</a>
            <a href="jieshao.html#meiduan">美短</a>
        </div>
    </div>

    <!-- 用户中心主体内容 -->
    <div class="main" style="margin-bottom: 20px;">
        <div class="left" style="width: 250px;">
            <div class="gonggao" style="height: auto; padding-bottom: 20px;">
                <h3>用户菜单</h3>
                <div style="padding: 10px;">
                    <p><a href="#userInfo" style="color: #333; display: block; line-height: 30px;">个人信息</a></p>
                    <p><a href="#adoptRecord" style="color: #333; display: block; line-height: 30px;">领养记录</a></p>
                    <p><a href="#message" style="color: #333; display: block; line-height: 30px;">我的留言</a></p>
                    <p><a href="javascript:;" id="logoutBtn"
                            style="color: #333; display: block; line-height: 30px;">退出登录</a></p>
                </div>
            </div>
        </div>

        <div class="min" style="width: 680px;">
            <div id="userInfo" style="background: #f9f9f9; padding: 20px; border-radius: 5px;">
                <h2 style="text-align: left; border-bottom: 1px solid #00b8ee; padding-bottom: 10px;">个人信息</h2>
                <table style="width: 100%; margin-top: 20px; line-height: 2;">
                    <tr>
                        <td style="width: 120px; text-align: right; padding-right: 20px;">用户名：</td>
                        <td id="username">-</td>
                    </tr>
                    <tr>
                        <td style="text-align: right; padding-right: 20px;">手机号：</td>
                        <td id="phone">-</td>
                    </tr>
                    <tr>
                        <td style="text-align: right; padding-right: 20px;">注册时间：</td>
                        <td id="registerTime">-</td>
                    </tr>
                    <tr>
                        <td style="text-align: right; padding-right: 20px;">账号状态：</td>
                        <td>正常</td>
                    </tr>
                    <tr>
                        <td colspan="2" style="padding-top: 10px;">
                            <input type="button" value="修改密码" class="btn" style="margin-left: 140px; cursor: pointer;">
                        </td>
                    </tr>
                </table>
            </div>

            <div id="adoptRecord" style="background: #f9f9f9; padding: 20px; border-radius: 5px; margin-top: 20px;">
                <h2 style="text-align: left; border-bottom: 1px solid #00b8ee; padding-bottom: 10px;">领养记录</h2>
                <div id="adoptList" style="margin-top: 20px; text-align: center; padding: 30px;">
                    暂无领养记录，快去<a href="lingyang.html" style="color: #00b8ee;">领养小猫</a>吧！
                </div>
            </div>

            <div id="message" style="background: #f9f9f9; padding: 20px; border-radius: 5px; margin-top: 20px;">
                <h2 style="text-align: left; border-bottom: 1px solid #00b8ee; padding-bottom: 10px;">我的留言</h2>
                <div id="messageList" style="margin-top: 20px; text-align: center; padding: 30px;">
                    暂无留言记录，快去<a href="liuyan.html" style="color: #00b8ee;">在线留言</a>吧！
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>小猫网</p>
    </div>

    <script>
        // 页面加载时检查登录状态并加载用户信息
        document.addEventListener('DOMContentLoaded', function () {
            // 检查是否登录
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
            if (!currentUser) {
                alert('请先登录');
                window.location.href = 'denglu.html';
                return;
            }

            // 填充用户信息
            document.getElementById('username').textContent = currentUser.username;
            document.getElementById('phone').textContent = currentUser.phone;
            document.getElementById('registerTime').textContent = currentUser.registerTime;

            // 退出登录功能
            document.getElementById('logoutBtn').addEventListener('click', function () {
                if (confirm('确定要退出登录吗？')) {
                    localStorage.removeItem('currentUser');
                    window.location.href = 'index.html';
                }
            });

            // 修改密码功能
            document.querySelector('input[value="修改密码"]').addEventListener('click', function () {
                const oldPwd = prompt('请输入原密码：');
                if (oldPwd !== currentUser.password) {
                    alert('原密码错误');
                    return;
                }

                const newPwd = prompt('请输入新密码（不少于6位）：');
                if (!newPwd || newPwd.length < 6) {
                    alert('密码长度不能少于6位');
                    return;
                }

                const confirmPwd = prompt('请确认新密码：');
                if (newPwd !== confirmPwd) {
                    alert('两次密码输入不一致');
                    return;
                }

                // 更新密码
                const users = JSON.parse(localStorage.getItem('petUsers') || '[]');
                const userIndex = users.findIndex(u => u.username === currentUser.username);
                if (userIndex !== -1) {
                    users[userIndex].password = newPwd;
                    localStorage.setItem('petUsers', JSON.stringify(users));
                    // 更新当前用户信息
                    currentUser.password = newPwd;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    alert('密码修改成功');
                }
            });
        });
    </script>
</body>

</html>